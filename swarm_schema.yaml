schema_version: "1.1"

agents:
  Orchestrator:
    description: "Coordinates task flow and manages state using graph-based reasoning."
    ontology_role: "Product Manager"
  Coder:
    description: "Implements features and writes code based on specifications and feedback."
    ontology_role: "Frontend Developer"
  Reviewer:
    description: "Reviews code for quality, security, and spec adherence using static analysis and LLM reasoning."
    ontology_role: "QA Engineer"
  Deployer:
    description: "Verifies and deploys the application."
    ontology_role: "DevOps Engineer"

tasks:
  FeatureImplementationTask:
    handler: Coder
    description: "Implement a feature based on a specification."
    outputs: ["CodeArtifact"]
    required_permissions: ["CodeGenerationPermission"]
  CodeReviewTask:
    handler: Reviewer
    description: "Review the implemented code."
    inputs: ["CodeArtifact"]
    outputs: ["ReviewCritique", "LintError"]
    required_permissions: ["CodeReviewPermission"]
  DeploymentTask:
    handler: Deployer
    description: "Deploy the verified code."
    inputs: ["CodeArtifact"]
    outputs: ["DeploymentResult"]
    required_permissions: ["DeploymentPermission"]

transitions:
  FeatureImplementationTask:
    on_success: CodeReviewTask
    on_failure: FeatureImplementationTask

  CodeReviewTask:
    on_success: DeploymentTask
    on_failure: FeatureImplementationTask

  DeploymentTask:
    on_success: null
    on_failure: DeploymentTask

artifacts:
  CodeArtifact:
    description: "Source code file generated by Coder."
    properties:
      - path
      - language
      - content_hash
  ReviewCritique:
    description: "Feedback from Reviewer explaining why code was rejected."
    properties:
      - severity
      - message
      - file_path
      - line_number
  LintError:
    description: "Static analysis error found by tools like pylint/flake8."
    properties:
      - tool
      - code
      - message
      - line
  TestResult:
    description: "Result of a test execution."
    properties:
      - passed
      - output
  DeploymentResult:
    description: "Result of a deployment attempt."
    properties:
      - url
      - status
